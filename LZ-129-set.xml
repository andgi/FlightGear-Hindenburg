<?xml version="1.0"?>
<!-- $Id: LZ-129-set.xml,v 1.9 2007-05-27 22:39:26 anders Exp $ -->
<!--
  LZ-129 Hindenburg

  Copyright (C) 2006 - 2007  Anders Gidenstam  (anders(at)gidenstam.org)
  This file is licensed under the GPL license.
-->
<PropertyList include="LZ-129-common.xml">

 <sim>

  <description>LZ 129 Hindenburg (using the LTA JSBSim FDM)</description>

  <flight-model>jsb</flight-model>
  <aero>LZ-129</aero>

  <presets>
   <onground>true</onground>
  </presets>

  <systems>
   <electrical>
    <path/>
   </electrical>
  </systems>
<!--
  <instrumentation>
   <path>Aircraft/Submarine_Scout/Systems/instrumentation.xml</path>
  </instrumentation>
-->
 </sim>

 <!-- Temporary solution. -->
 <sound>
  <audible>true</audible>
  <path>Aircraft/Boeing314/Sounds/Boeing314-sound.xml</path>
 </sound>

 <nasal>
  <LZ129>
   <script>
    var ballastFore = "/fdm/jsbsim/propulsion/ballast-tank[0]/contents-slug";
    var ballastAft  = "/fdm/jsbsim/propulsion/ballast-tank[1]/contents-slug";
    var gascell     = "/fdm/jsbsim/propulsion/gas-cell";

    setForwardGasValves = func (v) {
       setprop(gascell ~ "[15]/valve_open", v);
       setprop(gascell ~ "[14]/valve_open", v);
       setprop(gascell ~ "[13]/valve_open", v);
       setprop(gascell ~ "[12]/valve_open", v);
       setprop(gascell ~ "[11]/valve_open", v);
       setprop(gascell ~ "[10]/valve_open", v);
       setprop(gascell ~ "[9]/valve_open", v);
       setprop(gascell ~ "[8]/valve_open", v);
    }

    setAftGasValves = func (v) {
       setprop(gascell ~ "[7]/valve_open", v);
       setprop(gascell ~ "[6]/valve_open", v);
       setprop(gascell ~ "[5]/valve_open", v);
       setprop(gascell ~ "[4]/valve_open", v);
       setprop(gascell ~ "[3]/valve_open", v);
       setprop(gascell ~ "[2]/valve_open", v);
       setprop(gascell ~ "[1]/valve_open", v);
       setprop(gascell ~ "[0]/valve_open", v);
    }

    init = func {
       var crew = "/sim/model/crew/";
       setprop(crew ~ "rudder_coxswain/visible", 1);
    }

    init();
   </script>
  </LZ129>
  <WeighOff>
   <script>
    var weight_on_gear =
      props.globals.getNode("/fdm/jsbsim/forces/fbz-gear-lbs");
    var ballast = "/fdm/jsbsim/propulsion/ballast-tank[2]/contents-slug";

    print_wow = func {
      gui.popupTip("Current weight on gear " ~
                   weight_on_gear.getValue() ~ " lbs.");
    }

    weighoff = func {
      gui.popupTip("Weigh-off to 10% in progress. " ~
                   "Current weight " ~ weight_on_gear.getValue() ~ " lbs.");
      slugtolb = 32.174049;
      lbtoslug = 1.0/slugtolb;
      wow = weight_on_gear.getValue();
      cont = getprop(ballast);
      interpolate(ballast,
                  cont + 0.90 * wow * lbtoslug,
                  10);
    }
   </script>
  </WeighOff>
 </nasal>

 <input>
  <keyboard>
   <!-- Keyboard commands -->

   <!-- Ballast commands ====================================== -->
   <key n="87"> 
    <name>W</name>
    <desc>Perform on-ground weigh-off.</desc>
    <binding> 
     <command>nasal</command>
     <script>
      WeighOff.weighoff();
     </script>     
    </binding>
   </key>
   <key n="119">
    <name>w</name>
    <desc>Show current on-ground weight.</desc>
    <binding>
     <command>nasal</command>
     <script>
      WeighOff.print_wow();
     </script>
    </binding>
   </key>
   <key n="100">
    <name>d</name>
    <desc>Drop 0.1% ballast aft</desc>
    <repeatable type="bool">true</repeatable>
    <binding>
     <command>nasal</command>
     <script>
       gui.popupTip("Dropping ballast aft! " ~
                    "Ballast left: " ~ getprop(LZ129.ballastAft) ~ " slug");
       interpolate(LZ129.ballastAft, 0.999 * getprop(LZ129.ballastAft), 0.5);
     </script>
    </binding>
   </key>
   <key n="68">
    <name>D</name>
    <desc>Drop 1% ballast aft</desc>
    <repeatable type="bool">true</repeatable>
    <binding>
     <command>nasal</command>
     <script>
       gui.popupTip("Dropping ballast aft! " ~
                    "Ballast left: " ~ getprop(LZ129.ballastAft) ~ " slug");
       interpolate(LZ129.ballastAft, 0.99 * getprop(LZ129.ballastAft), 0.5);
     </script>
    </binding>
   </key>
   <key n="115">
    <name>s</name>
    <desc>Drop 0.1% ballast fore</desc>
    <repeatable type="bool">true</repeatable>
    <binding>
     <command>nasal</command>
     <script>
       gui.popupTip("Dropping ballast fore! " ~
                    "Ballast left: " ~ getprop(LZ129.ballastFore) ~ " slug");
       interpolate(LZ129.ballastFore, 0.999 * getprop(LZ129.ballastFore), 0.5);
     </script>
    </binding>
   </key>
   <key n="83">
    <name>S</name>
    <desc>Drop 1% ballast fore</desc>
    <repeatable type="bool">true</repeatable>
    <binding>
     <command>nasal</command>
     <script>
       gui.popupTip("Dropping ballast fore! " ~
                    "Ballast left: " ~ getprop(LZ129.ballastFore) ~ " slug");
       interpolate(LZ129.ballastFore, 0.99 * getprop(LZ129.ballastFore), 0.5);
     </script>
    </binding>
   </key>
   
   <!-- Gas cell commands ====================================== -->
   <key n="70">
    <name>F</name>
    <desc>Open forward gas valves.</desc>
    <binding>
     <command>nasal</command>
     <script>
       gui.popupTip("Forward gas valves open!");
       LZ129.setForwardGasValves(1.00);
     </script>
    </binding>
   </key>
   <key n="102">
    <name>f</name>
    <desc>Close forward gas valves.</desc>
    <binding>
     <command>nasal</command>
     <script>
       gui.popupTip("Forward gas valves closed!");
       LZ129.setForwardGasValves(0.00);
     </script>
    </binding>
   </key>

   <key n="71">
    <name>G</name>
    <desc>Open aft gas valves.</desc>
    <binding>
     <command>nasal</command>
     <script>
       gui.popupTip("Aft gas valves open!");
       LZ129.setAftGasValves(1.00);
     </script>
    </binding>
   </key>
   <key n="103">
    <name>g</name>
    <desc>Close aft gas valves.</desc>
    <binding>
     <command>nasal</command>
     <script>
       gui.popupTip("Aft gas valves closed!");
       LZ129.setAftGasValves(0.00);
     </script>
    </binding>
   </key>

   <!-- Crew commands ========================================== -->
   <key n="69">
    <name>E</name>
    <desc>Activate elevator coxswain.</desc>
    <binding>
     <command>nasal</command>
     <script>
       setprop("/fdm/jsbsim/ap/elevator-coxswain-active",
               1);
     </script>
    </binding>
   </key>

   <key n="101">
    <name>e</name>
    <desc>Deativate elevator coxswain.</desc>
    <binding>
     <command>nasal</command>
     <script>
       setprop("/fdm/jsbsim/ap/elevator-coxswain-active",
               0);
     </script>
    </binding>
   </key>

   <key n="82">
    <name>R</name>
    <desc>Activate rudder coxswain.</desc>
    <binding>
     <command>nasal</command>
     <script>
       setprop("/fdm/jsbsim/ap/rudder-coxswain-active",
               1);
     </script>
    </binding>
   </key>
 
   <key n="114">
    <name>r</name>
    <desc>Deactivate rudder coxswain.</desc>
    <binding>
     <command>nasal</command>
     <script>
       setprop("/fdm/jsbsim/ap/rudder-coxswain-active",
               0);
     </script>
    </binding>
   </key>

  </keyboard>
 </input>

</PropertyList>
